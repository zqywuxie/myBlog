---
title: å•ä¾‹è®¾è®¡æ¨¡å¼
date: 2023-02-11 19:01:36
permalink: /pages/697071/
---
# 1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°

## 1.1 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯

"è®¾è®¡æ¨¡å¼"æœ€åˆå¹¶ä¸æ˜¯å‡ºç°åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œè€Œæ˜¯è¢«ç”¨äºå»ºç­‘é¢†åŸŸçš„è®¾è®¡ä¸­ã€‚

1977å¹´ç¾å›½è‘—åå»ºç­‘å¤§å¸ˆã€åŠ åˆ©ç¦å°¼äºšå¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡ç¯å¢ƒç»“æ„ä¸­å¿ƒä¸»ä»»`å…‹é‡Œæ–¯æ‰˜å¤«Â·äºšå†å±±å¤§ï¼ˆChristopher Alexanderï¼‰`åœ¨ä»–çš„è‘—ä½œã€Šå»ºç­‘æ¨¡å¼è¯­è¨€ï¼šåŸé•‡ã€å»ºç­‘ã€æ„é€ ã€‹ä¸­æè¿°äº†ä¸€äº›å¸¸è§çš„å»ºç­‘è®¾è®¡é—®é¢˜ï¼Œå¹¶æå‡ºäº† 253 ç§å…³äºå¯¹åŸé•‡ã€é‚»é‡Œã€ä½å®…ã€èŠ±å›­å’Œæˆ¿é—´ç­‰è¿›è¡Œè®¾è®¡çš„åŸºæœ¬æ¨¡å¼ã€‚

1990å¹´è½¯ä»¶å·¥ç¨‹ç•Œå¼€å§‹ç ”è®¨è®¾è®¡æ¨¡å¼çš„è¯é¢˜ï¼Œåæ¥å¬å¼€äº†å¤šæ¬¡å…³äºè®¾è®¡æ¨¡å¼çš„ç ”è®¨ä¼šã€‚ç›´åˆ°1995 å¹´ï¼Œè‰¾ç‘å…‹Â·ä¼½é©¬ï¼ˆErichGammaï¼‰ã€ç†æŸ»å¾·Â·æµ·å°”å§†ï¼ˆRichard Helmï¼‰ã€æ‹‰å°”å¤«Â·çº¦ç¿°æ£®ï¼ˆRalph Johnsonï¼‰ã€çº¦ç¿°Â·å¨åˆ©æ–¯è¿ªæ–¯ï¼ˆJohn Vlissidesï¼‰ç­‰ 4 ä½ä½œè€…åˆä½œå‡ºç‰ˆäº†ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦ï¼Œåœ¨æ­¤ä¹¦ä¸­æ”¶å½•äº† 23 ä¸ªè®¾è®¡æ¨¡å¼ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é¢†åŸŸé‡Œç¨‹ç¢‘çš„äº‹ä»¶ï¼Œå¯¼è‡´äº†è½¯ä»¶è®¾è®¡æ¨¡å¼çš„çªç ´ã€‚è¿™ 4 ä½ä½œè€…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸé‡Œä¹Ÿä»¥ä»–ä»¬çš„â€œå››äººç»„â€ï¼ˆGang of Fourï¼ŒGoFï¼‰è‘—ç§°ã€‚  

## 1.2 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ

è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ˆSoftware Design Patternï¼‰ï¼Œåˆç§°è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚å®ƒæè¿°äº†åœ¨è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­çš„ä¸€äº›ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„ä¸€ç³»åˆ—å¥—è·¯ï¼Œæ˜¯å‰è¾ˆä»¬çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå…·æœ‰ä¸€å®šçš„æ™®éæ€§ï¼Œå¯ä»¥åå¤ä½¿ç”¨ã€‚

## 1.3 å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§

**è®¾è®¡æ¨¡å¼çš„æœ¬è´¨æ˜¯é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™çš„å®é™…è¿ç”¨**ï¼Œæ˜¯å¯¹ç±»çš„å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ä»¥åŠç±»çš„å…³è”å…³ç³»å’Œç»„åˆå…³ç³»çš„å……åˆ†ç†è§£ã€‚

æ­£ç¡®ä½¿ç”¨è®¾è®¡æ¨¡å¼å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ã€‚

- å¯ä»¥æé«˜ç¨‹åºå‘˜çš„æ€ç»´èƒ½åŠ›ã€ç¼–ç¨‹èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ã€‚
- ä½¿ç¨‹åºè®¾è®¡æ›´åŠ æ ‡å‡†åŒ–ã€ä»£ç ç¼–åˆ¶æ›´åŠ å·¥ç¨‹åŒ–ï¼Œä½¿è½¯ä»¶å¼€å‘æ•ˆç‡å¤§å¤§æé«˜ï¼Œä»è€Œç¼©çŸ­è½¯ä»¶çš„å¼€å‘å‘¨æœŸã€‚
- ä½¿è®¾è®¡çš„ä»£ç å¯é‡ç”¨æ€§é«˜ã€å¯è¯»æ€§å¼ºã€å¯é æ€§é«˜ã€çµæ´»æ€§å¥½ã€å¯ç»´æŠ¤æ€§å¼ºã€‚

## 1.4 è®¾è®¡æ¨¡å¼åˆ†ç±»

* **åˆ›å»ºå‹æ¨¡å¼**

  **ç”¨äºæè¿°â€œæ€æ ·åˆ›å»ºå¯¹è±¡â€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ã€‚**GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†å•ä¾‹ã€åŸå‹ã€å·¥å‚æ–¹æ³•ã€æŠ½è±¡å·¥å‚ã€å»ºé€ è€…ç­‰ 5 ç§åˆ›å»ºå‹æ¨¡å¼ã€‚

* **ç»“æ„å‹æ¨¡å¼**

  ç”¨äºæè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡**æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„**

  GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†ä»£ç†ã€é€‚é…å™¨ã€æ¡¥æ¥ã€è£…é¥°ã€å¤–è§‚ã€äº«å…ƒã€ç»„åˆç­‰ 7 ç§ç»“æ„å‹æ¨¡å¼ã€‚

* **è¡Œä¸ºå‹æ¨¡å¼**

  ç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·**ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡**ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ã€‚GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†æ¨¡æ¿æ–¹æ³•ã€ç­–ç•¥ã€å‘½ä»¤ã€èŒè´£é“¾ã€çŠ¶æ€ã€è§‚å¯Ÿè€…ã€ä¸­ä»‹è€…ã€è¿­ä»£å™¨ã€è®¿é—®è€…ã€å¤‡å¿˜å½•ã€è§£é‡Šå™¨ç­‰ 11 ç§è¡Œä¸ºå‹æ¨¡å¼ã€‚



# 2ï¼ŒUMLå›¾

**ç»Ÿä¸€å»ºæ¨¡è¯­è¨€**ï¼ˆUnified Modeling Languageï¼ŒUMLï¼‰æ˜¯ç”¨æ¥è®¾è®¡è½¯ä»¶çš„å¯è§†åŒ–å»ºæ¨¡è¯­è¨€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç®€å•ã€ç»Ÿä¸€ã€**å›¾å½¢åŒ–**ã€èƒ½è¡¨è¾¾è½¯ä»¶è®¾è®¡ä¸­çš„åŠ¨æ€ä¸é™æ€ä¿¡æ¯ã€‚

UML ä»ç›®æ ‡ç³»ç»Ÿçš„ä¸åŒè§’åº¦å‡ºå‘ï¼Œå®šä¹‰äº†ç”¨ä¾‹å›¾ã€ç±»å›¾ã€å¯¹è±¡å›¾ã€çŠ¶æ€å›¾ã€æ´»åŠ¨å›¾ã€æ—¶åºå›¾ã€åä½œå›¾ã€æ„ä»¶å›¾ã€éƒ¨ç½²å›¾ç­‰ 9 ç§å›¾ã€‚

## 2.1 ç±»å›¾æ¦‚è¿°

**ç±»å›¾(Class diagram)æ˜¯æ˜¾ç¤ºäº†æ¨¡å‹çš„é™æ€ç»“æ„**ï¼Œç‰¹åˆ«æ˜¯æ¨¡å‹ä¸­å­˜åœ¨çš„ç±»ã€ç±»çš„å†…éƒ¨ç»“æ„ä»¥åŠå®ƒä»¬ä¸å…¶ä»–ç±»çš„å…³ç³»ç­‰ã€‚**ç±»å›¾ä¸æ˜¾ç¤ºæš‚æ—¶æ€§çš„ä¿¡æ¯**ã€‚ç±»å›¾æ˜¯é¢å‘å¯¹è±¡å»ºæ¨¡çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ã€‚

## 2.2 ç±»å›¾çš„ä½œç”¨

* åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œç±»å›¾æ˜¯ä¸€ç§é™æ€çš„ç»“æ„å›¾ï¼Œæè¿°äº†ç³»ç»Ÿçš„ç±»çš„é›†åˆï¼Œç±»çš„å±æ€§å’Œç±»ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ç®€åŒ–äº†äººä»¬å¯¹ç³»ç»Ÿçš„ç†è§£ï¼›
* ç±»å›¾æ˜¯ç³»ç»Ÿåˆ†æå’Œè®¾è®¡é˜¶æ®µçš„é‡è¦äº§ç‰©ï¼Œæ˜¯ç³»ç»Ÿç¼–ç å’Œæµ‹è¯•çš„é‡è¦æ¨¡å‹ã€‚

## 2.3 ç±»å›¾è¡¨ç¤ºæ³•

### 2.3.1 ç±»çš„è¡¨ç¤ºæ–¹å¼ 

åœ¨UMLç±»å›¾ä¸­ï¼Œç±»ä½¿ç”¨åŒ…å«ç±»åã€å±æ€§(field) å’Œæ–¹æ³•(method) ä¸”å¸¦æœ‰åˆ†å‰²çº¿çš„çŸ©å½¢æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ä¸‹å›¾è¡¨ç¤ºä¸€ä¸ªEmployeeç±»ï¼Œå®ƒåŒ…å«name,ageå’Œaddressè¿™3ä¸ªå±æ€§ï¼Œä»¥åŠwork()æ–¹æ³•ã€‚ 

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/Employee.jpg)

å±æ€§/æ–¹æ³•åç§°å‰åŠ çš„åŠ å·å’Œå‡å·è¡¨ç¤ºäº†è¿™ä¸ªå±æ€§/æ–¹æ³•çš„å¯è§æ€§ï¼ŒUMLç±»å›¾ä¸­è¡¨ç¤ºå¯è§æ€§çš„ç¬¦å·æœ‰ä¸‰ç§ï¼š

* +ï¼šè¡¨ç¤ºpublic
* -ï¼šè¡¨ç¤ºprivate
* #ï¼šè¡¨ç¤ºprotected
* ä¸åŠ ï¼šè¡¨ç¤ºdefault

|                     |          |          |              |                |
| ------------------- | -------- | -------- | ------------ | -------------- |
|                     | åŒä¸€ä¸ªç±» | åŒä¸€ä¸ªåŒ… | ä¸åŒåŒ…çš„å­ç±» | ä¸åŒåŒ…çš„éå­ç±» |
| pubulic(å…¬å…±çš„)     | ğŸ•        | ğŸ•        | ğŸ•            | ğŸ•              |
| protected(å—ä¿æŠ¤çš„) | ğŸ•        | ğŸ•        | ğŸ•            |                |
| default(é»˜è®¤çš„)     | ğŸ•        | ğŸ•        |              |                |
| private(ç§æœ‰çš„)     | ğŸ•        |          |              |                |

å±æ€§çš„å®Œæ•´è¡¨ç¤ºæ–¹å¼æ˜¯ï¼š **å¯è§æ€§  åç§° ï¼šç±»å‹ [ = ç¼ºçœå€¼]**  

æ–¹æ³•çš„å®Œæ•´è¡¨ç¤ºæ–¹å¼æ˜¯ï¼š **å¯è§æ€§  åç§°(å‚æ•°åˆ—è¡¨) [ ï¼š è¿”å›ç±»å‹]**

> æ³¨æ„ï¼š
>
> â€‹	1ï¼Œä¸­æ‹¬å·ä¸­çš„å†…å®¹è¡¨ç¤ºæ˜¯å¯é€‰çš„
>
> â€‹	2ï¼Œä¹Ÿæœ‰å°†ç±»å‹æ”¾åœ¨å˜é‡åå‰é¢ï¼Œ- String name
>
> è¿”å›å€¼ç±»å‹æ”¾åœ¨æ–¹æ³•åå‰é¢+ void work()

**ä¸¾ä¸ªæ —å­ï¼š**

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/demo.png)

ä¸Šå›¾Demoç±»å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼š

* method()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºpublicï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚
* method1()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºprivateï¼Œæ²¡æœ‰å‚æ•°ï¼Œè¿”å›å€¼ç±»å‹ä¸ºStringã€‚
* method2()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºprotectedï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºintï¼Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸ºStringï¼Œè¿”å›å€¼ç±»å‹æ˜¯intã€‚

### 2.3.2 ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼

#### 2.3.2.1 å…³è”å…³ç³»

å…³è”å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´çš„ä¸€ç§**å¼•ç”¨å…³ç³»**ï¼Œç”¨äºè¡¨ç¤ºä¸€ç±»å¯¹è±¡ä¸å¦ä¸€ç±»å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œå¦‚è€å¸ˆå’Œå­¦ç”Ÿã€å¸ˆå‚…å’Œå¾’å¼Ÿã€ä¸ˆå¤«å’Œå¦»å­ç­‰ã€‚å…³è”å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´æœ€å¸¸ç”¨çš„ä¸€ç§å…³ç³»ï¼Œåˆ†ä¸ºä¸€èˆ¬å…³è”å…³ç³»ã€èšåˆå…³ç³»å’Œç»„åˆå…³ç³»ã€‚æˆ‘ä»¬å…ˆä»‹ç»ä¸€èˆ¬å…³è”ã€‚

å…³è”åˆå¯ä»¥åˆ†ä¸ºå•å‘å…³è”ï¼ŒåŒå‘å…³è”ï¼Œè‡ªå…³è”ã€‚

**1ï¼Œå•å‘å…³è”**

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/customer_address.png)

åœ¨UMLç±»å›¾ä¸­å•å‘å…³è”ç”¨ä¸€ä¸ªå¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤ºã€‚ä¸Šå›¾è¡¨ç¤ºæ¯ä¸ªé¡¾å®¢éƒ½æœ‰ä¸€ä¸ªåœ°å€ï¼Œè¿™é€šè¿‡è®©Customerç±»æŒæœ‰ä¸€ä¸ªç±»å‹ä¸ºAddressçš„æˆå‘˜å˜é‡ç±»å®ç°ã€‚

**2ï¼ŒåŒå‘å…³è”**

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/customer_product.png)

ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œæ‰€è°“çš„åŒå‘å…³è”å°±æ˜¯åŒæ–¹å„è‡ªæŒæœ‰å¯¹æ–¹ç±»å‹çš„æˆå‘˜å˜é‡ã€‚

åœ¨UMLç±»å›¾ä¸­ï¼Œ**åŒå‘å…³è”ç”¨ä¸€ä¸ªä¸å¸¦ç®­å¤´çš„ç›´çº¿è¡¨ç¤º**ã€‚ä¸Šå›¾ä¸­åœ¨Customerç±»ä¸­ç»´æŠ¤ä¸€ä¸ªList\<Product>ï¼Œè¡¨ç¤ºä¸€ä¸ªé¡¾å®¢å¯ä»¥è´­ä¹°å¤šä¸ªå•†å“ï¼›åœ¨Productç±»ä¸­ç»´æŠ¤ä¸€ä¸ªCustomerç±»å‹çš„æˆå‘˜å˜é‡è¡¨ç¤ºè¿™ä¸ªäº§å“è¢«å“ªä¸ªé¡¾å®¢æ‰€è´­ä¹°ã€‚

**3ï¼Œè‡ªå…³è”**

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/node.png)

è‡ªå…³è”åœ¨UMLç±»å›¾ä¸­ç”¨ä¸€ä¸ªå¸¦æœ‰ç®­å¤´ä¸”æŒ‡å‘è‡ªèº«çš„çº¿è¡¨ç¤ºã€‚ä¸Šå›¾çš„æ„æ€å°±æ˜¯Nodeç±»åŒ…å«ç±»å‹ä¸ºNodeçš„æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯â€œè‡ªå·±åŒ…å«è‡ªå·±â€ã€‚(é“¾è¡¨)

#### 2.3.2.2 èšåˆå…³ç³»

èšåˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯**å¼ºå…³è”å…³ç³»**ï¼Œæ˜¯**æ•´ä½“å’Œéƒ¨åˆ†ä¹‹é—´**çš„å…³ç³»ã€‚

èšåˆå…³ç³»ä¹Ÿæ˜¯é€šè¿‡æˆå‘˜å¯¹è±¡æ¥å®ç°çš„ï¼Œå…¶ä¸­æˆå‘˜å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯**æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡è€Œç‹¬ç«‹å­˜åœ¨**ã€‚ä¾‹å¦‚ï¼Œå­¦æ ¡ä¸è€å¸ˆçš„å…³ç³»ï¼Œå­¦æ ¡åŒ…å«è€å¸ˆï¼Œä½†å¦‚æœå­¦æ ¡åœåŠäº†ï¼Œè€å¸ˆä¾ç„¶å­˜åœ¨ã€‚

åœ¨ UML ç±»å›¾ä¸­ï¼Œèšåˆå…³ç³»å¯ä»¥ç”¨å¸¦ç©ºå¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œ**è±å½¢æŒ‡å‘æ•´ä½“**ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¤§å­¦å’Œæ•™å¸ˆçš„å…³ç³»å›¾ï¼š

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/image-20191229173422328.png)

#### 2.3.2.3 ç»„åˆå…³ç³»

ç»„åˆè¡¨ç¤ºç±»ä¹‹é—´çš„æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œä½†å®ƒæ˜¯ä¸€ç§æ›´å¼ºçƒˆçš„èšåˆå…³ç³»ã€‚

åœ¨ç»„åˆå…³ç³»ä¸­ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥æ§åˆ¶éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œ**éƒ¨åˆ†å¯¹è±¡ä¸èƒ½è„±ç¦»æ•´ä½“å¯¹è±¡è€Œå­˜åœ¨**ã€‚ä¾‹å¦‚ï¼Œå¤´å’Œå˜´çš„å…³ç³»ï¼Œæ²¡æœ‰äº†å¤´ï¼Œå˜´ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚

åœ¨ UML ç±»å›¾ä¸­ï¼Œç»„åˆå…³ç³»ç”¨å¸¦å®å¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¤´å’Œå˜´çš„å…³ç³»å›¾ï¼š

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/image-20191229173455149.png)



#### 2.3.2.4 ä¾èµ–å…³ç³»

ä¾èµ–å…³ç³»æ˜¯ä¸€ç§**ä½¿ç”¨å…³ç³»**ï¼Œå®ƒæ˜¯å¯¹è±¡ä¹‹é—´**è€¦åˆåº¦æœ€å¼±**çš„ä¸€ç§å…³è”æ–¹å¼ï¼Œ**æ˜¯ä¸´æ—¶æ€§çš„å…³è”**ã€‚åœ¨ä»£ç ä¸­ï¼ŒæŸä¸ªç±»çš„æ–¹æ³•é€šè¿‡å±€éƒ¨å˜é‡ã€æ–¹æ³•çš„å‚æ•°æˆ–è€…å¯¹é™æ€æ–¹æ³•çš„è°ƒç”¨æ¥è®¿é—®å¦ä¸€ä¸ªç±»ï¼ˆè¢«ä¾èµ–ç±»ï¼‰ä¸­çš„æŸäº›æ–¹æ³•æ¥å®Œæˆä¸€äº›èŒè´£ã€‚

åœ¨ UML ç±»å›¾ä¸­ï¼Œä¾èµ–å…³ç³»ä½¿ç”¨å¸¦ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´**ä»ä½¿ç”¨ç±»æŒ‡å‘è¢«ä¾èµ–çš„ç±»**ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¸æœºå’Œæ±½è½¦çš„å…³ç³»å›¾ï¼Œå¸æœºé©¾é©¶æ±½è½¦ï¼š

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/image-20191229173518926.png)

#### 2.3.2.5 ç»§æ‰¿å…³ç³»

ç»§æ‰¿å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´**è€¦åˆåº¦æœ€å¤§**çš„ä¸€ç§å…³ç³»ï¼Œè¡¨ç¤ºä¸€èˆ¬ä¸ç‰¹æ®Šçš„å…³ç³»ï¼Œæ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ä¸€ç§ç»§æ‰¿å…³ç³»ã€‚

åœ¨ UML ç±»å›¾ä¸­ï¼Œç»§æ‰¿(æ³›åŒ–)å…³ç³»ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚åœ¨ä»£ç å®ç°æ—¶ï¼Œä½¿ç”¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿æœºåˆ¶æ¥å®ç°æ³›åŒ–å…³ç³»ã€‚ä¾‹å¦‚ï¼ŒStudent ç±»å’Œ Teacher ç±»éƒ½æ˜¯ Person ç±»çš„å­ç±»ï¼Œå…¶ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/image-20191229173539838.png)



#### 2.3.2.6 å®ç°å…³ç³»

å®ç°å…³ç³»æ˜¯æ¥å£ä¸å®ç°ç±»ä¹‹é—´çš„å…³ç³»ã€‚åœ¨è¿™ç§å…³ç³»ä¸­ï¼Œç±»å®ç°äº†æ¥å£ï¼Œç±»ä¸­çš„æ“ä½œå®ç°äº†æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰çš„æŠ½è±¡æ“ä½œã€‚

åœ¨ UML ç±»å›¾ä¸­ï¼Œå®ç°å…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å®ç°ç±»æŒ‡å‘æ¥å£ã€‚ä¾‹å¦‚ï¼Œæ±½è½¦å’Œèˆ¹å®ç°äº†äº¤é€šå·¥å…·ï¼Œå…¶ç±»å›¾å¦‚å›¾ 9 æ‰€ç¤ºã€‚

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/image-20191229173554296.png)

  



# 3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™

åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä¸ºäº†æé«˜è½¯ä»¶ç³»ç»Ÿçš„**å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ï¼Œå¢åŠ è½¯ä»¶çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§**ï¼Œç¨‹åºå‘˜è¦å°½é‡æ ¹æ®6æ¡åŸåˆ™æ¥å¼€å‘ç¨‹åºï¼Œä»è€Œæé«˜è½¯ä»¶å¼€å‘æ•ˆç‡ã€èŠ‚çº¦è½¯ä»¶å¼€å‘æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ã€‚

## 3.1 å¼€é—­åŸåˆ™

**å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­**ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‹“å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸæœ‰çš„ä»£ç ï¼Œå®ç°ä¸€ä¸ª**çƒ­æ’æ‹”(å®¢åˆ¶åŒ–é”®ç›˜ æ”¹å˜è½´é”®å¸½,ä½†ä¸ä¿®æ”¹å¥—ä»¶)çš„æ•ˆæœ**ã€‚ç®€è¨€ä¹‹ï¼Œæ˜¯ä¸ºäº†ä½¿ç¨‹åºçš„æ‰©å±•æ€§å¥½ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚

æƒ³è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»ã€‚

å› ä¸ºæŠ½è±¡çµæ´»æ€§å¥½ï¼Œé€‚åº”æ€§å¹¿ï¼Œåªè¦æŠ½è±¡çš„åˆç†ï¼Œå¯ä»¥åŸºæœ¬ä¿æŒè½¯ä»¶æ¶æ„çš„ç¨³å®šã€‚è€Œè½¯ä»¶ä¸­æ˜“å˜çš„ç»†èŠ‚å¯ä»¥ä»æŠ½è±¡æ´¾ç”Ÿæ¥çš„å®ç°ç±»æ¥è¿›è¡Œæ‰©å±•ï¼Œå½“è½¯ä»¶éœ€è¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªéœ€è¦æ ¹æ®éœ€æ±‚é‡æ–°æ´¾ç”Ÿä¸€ä¸ªå®ç°ç±»æ¥æ‰©å±•å°±å¯ä»¥äº†ã€‚

ä¸‹é¢ä»¥ `æœç‹—è¾“å…¥æ³•` çš„çš®è‚¤ä¸ºä¾‹ä»‹ç»å¼€é—­åŸåˆ™çš„åº”ç”¨ã€‚

ã€ä¾‹ã€‘`æœç‹—è¾“å…¥æ³•` çš„çš®è‚¤è®¾è®¡ã€‚

åˆ†æï¼š`æœç‹—è¾“å…¥æ³•` çš„çš®è‚¤æ˜¯è¾“å…¥æ³•èƒŒæ™¯å›¾ç‰‡ã€çª—å£é¢œè‰²å’Œå£°éŸ³ç­‰å…ƒç´ çš„ç»„åˆã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œçˆ±æ›´æ¢è‡ªå·±çš„è¾“å…¥æ³•çš„çš®è‚¤ï¼Œä¹Ÿå¯ä»¥ä»ç½‘ä¸Šä¸‹è½½æ–°çš„çš®è‚¤ã€‚è¿™äº›çš®è‚¤æœ‰å…±åŒçš„ç‰¹ç‚¹ï¼Œå¯ä»¥ä¸ºå…¶å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»ï¼ˆAbstractSkinï¼‰ï¼Œè€Œæ¯ä¸ªå…·ä½“çš„çš®è‚¤ï¼ˆDefaultSpecificSkinå’ŒHeimaSpecificSkinï¼‰æ˜¯å…¶å­ç±»ã€‚ç”¨æˆ·çª—ä½“å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æˆ–è€…å¢åŠ æ–°çš„ä¸»é¢˜ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åŸä»£ç ï¼Œæ‰€ä»¥å®ƒæ˜¯æ»¡è¶³å¼€é—­åŸåˆ™çš„ã€‚

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/open-close.png)



## 3.2 é‡Œæ°ä»£æ¢åŸåˆ™

é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€ã€‚

é‡Œæ°ä»£æ¢åŸåˆ™ï¼š**ä»»ä½•åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°**ã€‚é€šä¿—ç†è§£ï¼šå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œé™¤æ·»åŠ æ–°çš„æ–¹æ³•å®Œæˆæ–°å¢åŠŸèƒ½å¤–ï¼Œ**å­ç±»å°½é‡ä¸è¦é‡å†™çˆ¶ç±»çš„æ–¹æ³•**ã€‚

å¦‚æœé€šè¿‡é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ¥å®Œæˆæ–°çš„åŠŸèƒ½ï¼Œè¿™æ ·å†™èµ·æ¥è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ•´ä¸ªç»§æ‰¿ä½“ç³»çš„å¯å¤ç”¨æ€§ä¼šæ¯”è¾ƒå·®ï¼Œç‰¹åˆ«æ˜¯è¿ç”¨å¤šæ€æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œç¨‹åºè¿è¡Œå‡ºé”™çš„æ¦‚ç‡ä¼šéå¸¸å¤§ã€‚

ä¸‹é¢çœ‹ä¸€ä¸ªé‡Œæ°æ›¿æ¢åŸåˆ™ä¸­ç»å…¸çš„ä¸€ä¸ªä¾‹å­

ã€ä¾‹ã€‘æ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢ã€‚

åœ¨æ•°å­¦é¢†åŸŸé‡Œï¼Œæ­£æ–¹å½¢æ¯«æ— ç–‘é—®æ˜¯é•¿æ–¹å½¢ï¼Œå®ƒæ˜¯ä¸€ä¸ªé•¿å®½ç›¸ç­‰çš„é•¿æ–¹å½¢ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼€å‘çš„ä¸€ä¸ªä¸å‡ ä½•å›¾å½¢ç›¸å…³çš„è½¯ä»¶ç³»ç»Ÿï¼Œå°±å¯ä»¥é¡ºç†æˆç« çš„è®©æ­£æ–¹å½¢ç»§æ‰¿è‡ªé•¿æ–¹å½¢ã€‚

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/æ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢.png)

ä»£ç å¦‚ä¸‹ï¼š

**é•¿æ–¹å½¢ç±»ï¼ˆRectangleï¼‰ï¼š**

```java
public class Rectangle {
    private double length;
    private double width;

    public double getLength() {
        return length;
    }

    public void setLength(double length) {
        this.length = length;
    }

    public double getWidth() {
        return width;
    }

    public void setWidth(double width) {
        this.width = width;
    }
}
```

**æ­£æ–¹å½¢ï¼ˆSquareï¼‰ï¼š**

ç”±äºæ­£æ–¹å½¢çš„é•¿å’Œå®½ç›¸åŒï¼Œæ‰€ä»¥åœ¨æ–¹æ³•setLengthå’ŒsetWidthä¸­ï¼Œå¯¹é•¿åº¦å’Œå®½åº¦éƒ½éœ€è¦èµ‹ç›¸åŒå€¼ã€‚

```java
public class Square extends Rectangle {
    
    public void setWidth(double width) {
        super.setLength(width);
        super.setWidth(width);
    }

    public void setLength(double length) {
        super.setLength(length);
        super.setWidth(length);
    }
}
```

ç±»RectangleDemoæ˜¯æˆ‘ä»¬çš„è½¯ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒæœ‰ä¸€ä¸ªresizeæ–¹æ³•ä¾èµ–åŸºç±»Rectangleï¼Œresizeæ–¹æ³•æ˜¯RectandleDemoç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥å®ç°å®½åº¦é€æ¸å¢é•¿çš„æ•ˆæœã€‚

```java
public class RectangleDemo {
    
    public static void resize(Rectangle rectangle) {
        while (rectangle.getWidth() < rectangle.getLength()) {
            rectangle.setWidth(rectangle.getWidth() + 1);
        }
    }

    //æ‰“å°é•¿æ–¹å½¢çš„é•¿å’Œå®½
    public static void printLengthAndWidth(Rectangle rectangle) {
        System.out.println(rectangle.getLength());
        System.out.println(rectangle.getWidth());
    }

    public static void main(String[] args) {
        Rectangle rectangle = new Rectangle();
        rectangle.setLength(20);
        rectangle.setWidth(10);
        resize(rectangle);
        printLengthAndWidth(rectangle);

        System.out.println("============");

        Rectangle rectangle1 = new Square();
        rectangle1.setLength(10);
        resize(rectangle1);
        printLengthAndWidth(rectangle1);
    }
}
```

æˆ‘ä»¬è¿è¡Œä¸€ä¸‹è¿™æ®µä»£ç å°±ä¼šå‘ç°ï¼Œå‡å¦‚æˆ‘ä»¬æŠŠä¸€ä¸ªæ™®é€šé•¿æ–¹å½¢ä½œä¸ºå‚æ•°ä¼ å…¥resizeæ–¹æ³•ï¼Œå°±ä¼šçœ‹åˆ°é•¿æ–¹å½¢å®½åº¦é€æ¸å¢é•¿çš„æ•ˆæœï¼Œå½“å®½åº¦å¤§äºé•¿åº¦,ä»£ç å°±ä¼šåœæ­¢ï¼Œè¿™ç§è¡Œä¸ºçš„ç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼›å‡å¦‚æˆ‘ä»¬å†æŠŠä¸€ä¸ªæ­£æ–¹å½¢ä½œä¸ºå‚æ•°ä¼ å…¥resizeæ–¹æ³•åï¼Œå°±ä¼šçœ‹åˆ°æ­£æ–¹å½¢çš„å®½åº¦å’Œé•¿åº¦éƒ½åœ¨ä¸æ–­å¢é•¿ï¼Œä»£ç ä¼šä¸€ç›´è¿è¡Œä¸‹å»ï¼Œç›´è‡³ç³»ç»Ÿäº§ç”Ÿæº¢å‡ºé”™è¯¯ã€‚æ‰€ä»¥ï¼Œæ™®é€šçš„é•¿æ–¹å½¢æ˜¯é€‚åˆè¿™æ®µä»£ç çš„ï¼Œæ­£æ–¹å½¢ä¸é€‚åˆã€‚
æˆ‘ä»¬å¾—å‡ºç»“è®ºï¼šåœ¨resizeæ–¹æ³•ä¸­ï¼ŒRectangleç±»å‹çš„å‚æ•°æ˜¯ä¸èƒ½è¢«Squareç±»å‹çš„å‚æ•°æ‰€ä»£æ›¿ï¼Œå¦‚æœè¿›è¡Œäº†æ›¿æ¢å°±å¾—ä¸åˆ°é¢„æœŸç»“æœã€‚å› æ­¤ï¼ŒSquareç±»å’ŒRectangleç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»è¿åäº†é‡Œæ°ä»£æ¢åŸåˆ™ï¼Œå®ƒä»¬ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ä¸æˆç«‹ï¼Œæ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢ã€‚

å¦‚ä½•æ”¹è¿›å‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬éœ€è¦é‡æ–°è®¾è®¡ä»–ä»¬ä¹‹é—´çš„å…³ç³»ã€‚æŠ½è±¡å‡ºæ¥ä¸€ä¸ªå››è¾¹å½¢æ¥å£(Quadrilateral)ï¼Œè®©Rectangleç±»å’ŒSquareç±»å®ç°Quadrilateralæ¥å£

<img src="
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/æ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢æ”¹è¿›.png" style="zoom:80%;" />



## 3.3 ä¾èµ–å€’è½¬åŸåˆ™

é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚**ç®€å•çš„è¯´å°±æ˜¯è¦æ±‚å¯¹æŠ½è±¡è¿›è¡Œç¼–ç¨‹ï¼Œä¸è¦å¯¹å®ç°è¿›è¡Œç¼–ç¨‹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä¸å®ç°æ¨¡å—é—´çš„è€¦åˆã€‚**

ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£ä¾èµ–å€’è½¬åŸåˆ™

ã€ä¾‹ã€‘ç»„è£…ç”µè„‘

ç°è¦ç»„è£…ä¸€å°ç”µè„‘ï¼Œéœ€è¦é…ä»¶cpuï¼Œç¡¬ç›˜ï¼Œå†…å­˜æ¡ã€‚åªæœ‰è¿™äº›é…ç½®éƒ½æœ‰äº†ï¼Œè®¡ç®—æœºæ‰èƒ½æ­£å¸¸çš„è¿è¡Œã€‚é€‰æ‹©cpuæœ‰å¾ˆå¤šé€‰æ‹©ï¼Œå¦‚Intelï¼ŒAMDç­‰ï¼Œç¡¬ç›˜å¯ä»¥é€‰æ‹©å¸Œæ·ï¼Œè¥¿æ•°ç­‰ï¼Œå†…å­˜æ¡å¯ä»¥é€‰æ‹©é‡‘å£«é¡¿ï¼Œæµ·ç›—èˆ¹ç­‰ã€‚

**ç±»å›¾å¦‚ä¸‹ï¼š**

<img src="
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/ä¾èµ–å€’è½¬åŸåˆ™.png" style="zoom:80%;" />

ä»£ç å¦‚ä¸‹ï¼š

**å¸Œæ·ç¡¬ç›˜ç±»ï¼ˆXiJieHardDiskï¼‰:**

```java
public class XiJieHardDisk implements HardDisk {

    public void save(String data) {
        System.out.println("ä½¿ç”¨å¸Œæ·ç¡¬ç›˜å­˜å‚¨æ•°æ®" + data);
    }

    public String get() {
        System.out.println("ä½¿ç”¨å¸Œæ·å¸Œæ·ç¡¬ç›˜å–æ•°æ®");
        return "æ•°æ®";
    }
}
```

**Intelå¤„ç†å™¨ï¼ˆIntelCpuï¼‰ï¼š**

```java
public class IntelCpu implements Cpu {

    public void run() {
        System.out.println("ä½¿ç”¨Intelå¤„ç†å™¨");
    }
}
```

**é‡‘å£«é¡¿å†…å­˜æ¡ï¼ˆKingstonMemoryï¼‰ï¼š**

```java
public class KingstonMemory implements Memory {

    public void save() {
        System.out.println("ä½¿ç”¨é‡‘å£«é¡¿ä½œä¸ºå†…å­˜æ¡");
    }
}
```

**ç”µè„‘ï¼ˆComputerï¼‰ï¼š**

```java
public class Computer {

    private XiJieHardDisk hardDisk;
    private IntelCpu cpu;
    private KingstonMemory memory;

    public IntelCpu getCpu() {
        return cpu;
    }

    public void setCpu(IntelCpu cpu) {
        this.cpu = cpu;
    }

    public KingstonMemory getMemory() {
        return memory;
    }

    public void setMemory(KingstonMemory memory) {
        this.memory = memory;
    }

    public XiJieHardDisk getHardDisk() {
        return hardDisk;
    }

    public void setHardDisk(XiJieHardDisk hardDisk) {
        this.hardDisk = hardDisk;
    }

    public void run() {
        System.out.println("è®¡ç®—æœºå·¥ä½œ");
        cpu.run();
        memory.save();
        String data = hardDisk.get();
        System.out.println("ä»ç¡¬ç›˜ä¸­è·å–çš„æ•°æ®ä¸ºï¼š" + data);
    }
}
```

**æµ‹è¯•ç±»ï¼ˆTestComputerï¼‰ï¼š**

æµ‹è¯•ç±»ç”¨æ¥ç»„è£…ç”µè„‘ã€‚

```java
public class TestComputer {
    public static void main(String[] args) {
        Computer computer = new Computer();
        computer.setHardDisk(new XiJieHardDisk());
        computer.setCpu(new IntelCpu());
        computer.setMemory(new KingstonMemory());

        computer.run();
    }
}
```

ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°å·²ç»ç»„è£…äº†ä¸€å°ç”µè„‘ï¼Œä½†æ˜¯ä¼¼ä¹ç»„è£…çš„ç”µè„‘çš„cpuåªèƒ½æ˜¯Intelçš„ï¼Œå†…å­˜æ¡åªèƒ½æ˜¯é‡‘å£«é¡¿çš„ï¼Œç¡¬ç›˜åªèƒ½æ˜¯å¸Œæ·çš„ï¼Œè¿™å¯¹ç”¨æˆ·è‚¯å®šæ˜¯ä¸å‹å¥½çš„ï¼Œç”¨æˆ·æœ‰äº†æœºç®±è‚¯å®šæ˜¯æƒ³æŒ‰ç…§è‡ªå·±çš„å–œå¥½ï¼Œé€‰æ‹©è‡ªå·±å–œæ¬¢çš„é…ä»¶ã€‚

æ ¹æ®ä¾èµ–å€’è½¬åŸåˆ™è¿›è¡Œæ”¹è¿›ï¼š

ä»£ç æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹Computerç±»ï¼Œè®©Computerç±»ä¾èµ–æŠ½è±¡ï¼ˆå„ä¸ªé…ä»¶çš„æ¥å£ï¼‰ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå„ä¸ªç»„ä»¶å…·ä½“çš„å®ç°ç±»ã€‚

**ç±»å›¾å¦‚ä¸‹ï¼š**

<img src="img/ä¾èµ–å€’è½¬åŸåˆ™æ”¹è¿›.png" alt="image-20191229173554296" style="zoom:70%;" />

**ç”µè„‘ï¼ˆComputerï¼‰ï¼š**

```java
public class Computer {

    private HardDisk hardDisk;
    private Cpu cpu;
    private Memory memory;

    public HardDisk getHardDisk() {
        return hardDisk;
    }

    public void setHardDisk(HardDisk hardDisk) {
        this.hardDisk = hardDisk;
    }

    public Cpu getCpu() {
        return cpu;
    }

    public void setCpu(Cpu cpu) {
        this.cpu = cpu;
    }

    public Memory getMemory() {
        return memory;
    }

    public void setMemory(Memory memory) {
        this.memory = memory;
    }

    public void run() {
        System.out.println("è®¡ç®—æœºå·¥ä½œ");
    }
}
```

é¢å‘å¯¹è±¡çš„å¼€å‘å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æŠ½è±¡çš„å˜åŒ–æ¦‚ç‡å¾ˆå°ï¼Œè®©ç”¨æˆ·ç¨‹åºä¾èµ–äºæŠ½è±¡ï¼Œå®ç°çš„ç»†èŠ‚ä¹Ÿä¾èµ–äºæŠ½è±¡ã€‚å³ä½¿å®ç°ç»†èŠ‚ä¸æ–­å˜åŠ¨ï¼Œåªè¦æŠ½è±¡ä¸å˜ï¼Œå®¢æˆ·ç¨‹åºå°±ä¸éœ€è¦å˜åŒ–ã€‚è¿™å¤§å¤§é™ä½äº†å®¢æˆ·ç¨‹åºä¸å®ç°ç»†èŠ‚çš„è€¦åˆåº¦ã€‚



## 3.4 æ¥å£éš”ç¦»åŸåˆ™

å®¢æˆ·ç«¯**ä¸åº”è¯¥è¢«è¿«ä¾èµ–äºå®ƒä¸ä½¿ç”¨çš„æ–¹æ³•**ï¼›ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚

ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£æ¥å£éš”ç¦»åŸåˆ™

ã€ä¾‹ã€‘å®‰å…¨é—¨æ¡ˆä¾‹

æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª`é»‘é©¬`å“ç‰Œçš„å®‰å…¨é—¨ï¼Œè¯¥å®‰å…¨é—¨å…·æœ‰é˜²ç«ã€é˜²æ°´ã€é˜²ç›—çš„åŠŸèƒ½ã€‚å¯ä»¥å°†é˜²ç«ï¼Œé˜²æ°´ï¼Œé˜²ç›—åŠŸèƒ½æå–æˆä¸€ä¸ªæ¥å£ï¼Œå½¢æˆä¸€å¥—è§„èŒƒã€‚ç±»å›¾å¦‚ä¸‹ï¼š

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/æ¥å£éš”ç¦»åŸåˆ™.png)

ä¸Šé¢çš„è®¾è®¡æˆ‘ä»¬å‘ç°äº†å®ƒå­˜åœ¨çš„é—®é¢˜ï¼Œé»‘é©¬å“ç‰Œçš„å®‰å…¨é—¨å…·æœ‰é˜²ç›—ï¼Œé˜²æ°´ï¼Œé˜²ç«çš„åŠŸèƒ½ã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬è¿˜éœ€è¦å†åˆ›å»ºä¸€ä¸ªä¼ æ™ºå“ç‰Œçš„å®‰å…¨é—¨ï¼Œè€Œè¯¥å®‰å…¨é—¨åªå…·æœ‰é˜²ç›—ã€é˜²æ°´åŠŸèƒ½å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶å¦‚æœå®ç°SafetyDooræ¥å£å°±è¿èƒŒäº†æ¥å£éš”ç¦»åŸåˆ™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¿›è¡Œä¿®æ”¹å‘¢ï¼Ÿçœ‹å¦‚ä¸‹ç±»å›¾ï¼š

![](
https://wuxie-image.oss-cn-chengdu.aliyuncs.com/2023/04/02/æ¥å£éš”ç¦»åŸåˆ™1.png)

ä»£ç å¦‚ä¸‹ï¼š

**AntiTheftï¼ˆæ¥å£ï¼‰ï¼š**

```java
public interface AntiTheft {
    void antiTheft();
}
```

**Fireproofï¼ˆæ¥å£ï¼‰ï¼š**

```java
public interface Fireproof {
    void fireproof();
}
```

**Waterproofï¼ˆæ¥å£ï¼‰ï¼š**

```java
public interface Waterproof {
    void waterproof();
}
```

**HeiMaSafetyDoorï¼ˆç±»ï¼‰ï¼š**

```java
public class HeiMaSafetyDoor implements AntiTheft,Fireproof,Waterproof {
    public void antiTheft() {
        System.out.println("é˜²ç›—");
    }

    public void fireproof() {
        System.out.println("é˜²ç«");
    }


    public void waterproof() {
        System.out.println("é˜²æ°´");
    }
}
```

**ItcastSafetyDoorï¼ˆç±»ï¼‰ï¼š**

```java
public class ItcastSafetyDoor implements AntiTheft,Fireproof {
    public void antiTheft() {
        System.out.println("é˜²ç›—");
    }

    public void fireproof() {
        System.out.println("é˜²ç«");
    }
}
```



## 3.5 è¿ªç±³ç‰¹æ³•åˆ™

è¿ªç±³ç‰¹æ³•åˆ™åˆå«**æœ€å°‘çŸ¥è¯†åŸåˆ™ã€‚**

åªå’Œä½ çš„ç›´æ¥æœ‹å‹äº¤è°ˆï¼Œä¸è·Ÿâ€œé™Œç”Ÿäººâ€è¯´è¯ï¼ˆTalk only to your immediate friends and not to strangersï¼‰ã€‚

å…¶å«ä¹‰æ˜¯ï¼šå¦‚æœä¸¤ä¸ªè½¯ä»¶å®ä½“æ— é¡»ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆå°±ä¸åº”å½“å‘ç”Ÿç›´æ¥çš„ç›¸äº’è°ƒç”¨ï¼Œ**å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹è½¬å‘è¯¥è°ƒç”¨**ã€‚å…¶ç›®çš„æ˜¯é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œ**æé«˜æ¨¡å—çš„ç›¸å¯¹ç‹¬ç«‹æ€§**ã€‚

è¿ªç±³ç‰¹æ³•åˆ™ä¸­çš„â€œæœ‹å‹â€æ˜¯æŒ‡ï¼šå½“å‰å¯¹è±¡æœ¬èº«ã€å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡ã€å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡ã€å½“å‰å¯¹è±¡çš„æ–¹æ³•å‚æ•°ç­‰ï¼Œè¿™äº›å¯¹è±¡åŒå½“å‰å¯¹è±¡å­˜åœ¨å…³è”ã€èšåˆæˆ–ç»„åˆå…³ç³»ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è¿™äº›å¯¹è±¡çš„æ–¹æ³•ã€‚

ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿ªç±³ç‰¹æ³•åˆ™

ã€ä¾‹ã€‘æ˜æ˜Ÿä¸ç»çºªäººçš„å…³ç³»å®ä¾‹

æ˜æ˜Ÿç”±äºå…¨èº«å¿ƒæŠ•å…¥è‰ºæœ¯ï¼Œæ‰€ä»¥è®¸å¤šæ—¥å¸¸äº‹åŠ¡ç”±ç»çºªäººè´Ÿè´£å¤„ç†ï¼Œå¦‚å’Œç²‰ä¸çš„è§é¢ä¼šï¼Œå’Œåª’ä½“å…¬å¸çš„ä¸šåŠ¡æ´½æ·¡ç­‰ã€‚è¿™é‡Œçš„ç»çºªäººæ˜¯æ˜æ˜Ÿçš„æœ‹å‹ï¼Œè€Œç²‰ä¸å’Œåª’ä½“å…¬å¸æ˜¯é™Œç”Ÿäººï¼Œæ‰€ä»¥é€‚åˆä½¿ç”¨è¿ªç±³ç‰¹æ³•åˆ™ã€‚

ç±»å›¾å¦‚ä¸‹ï¼š

<img src="img/è¿ªç±³ç‰¹æ³•åˆ™.png" alt="image-20191229173554296" style="zoom:80%;" />

ä»£ç å¦‚ä¸‹ï¼š

**æ˜æ˜Ÿç±»ï¼ˆStarï¼‰**

```java
public class Star {
    private String name;

    public Star(String name) {
        this.name=name;
    }

    public String getName() {
        return name;
    }
}
```

**ç²‰ä¸ç±»ï¼ˆFansï¼‰**

```java
public class Fans {
    private String name;

    public Fans(String name) {
        this.name=name;
    }

    public String getName() {
        return name;
    }
}
```

**åª’ä½“å…¬å¸ç±»ï¼ˆCompanyï¼‰**

```java
public class Company {
    private String name;

    public Company(String name) {
        this.name=name;
    }

    public String getName() {
        return name;
    }
}
```

**ç»çºªäººç±»ï¼ˆAgentï¼‰**

```java
public class Agent {
    private Star star;
    private Fans fans;
    private Company company;

    public void setStar(Star star) {
        this.star = star;
    }

    public void setFans(Fans fans) {
        this.fans = fans;
    }

    public void setCompany(Company company) {
        this.company = company;
    }

    public void meeting() {
        System.out.println(fans.getName() + "ä¸æ˜æ˜Ÿ" + star.getName() + "è§é¢äº†ã€‚");
    }

    public void business() {
        System.out.println(company.getName() + "ä¸æ˜æ˜Ÿ" + star.getName() + "æ´½æ·¡ä¸šåŠ¡ã€‚");
    }
}
```



## 3.6 åˆæˆå¤ç”¨åŸåˆ™

åˆæˆå¤ç”¨åŸåˆ™æ˜¯æŒ‡ï¼šå°½é‡å…ˆä½¿ç”¨ç»„åˆæˆ–è€…èšåˆç­‰å…³è”å…³ç³»æ¥å®ç°ï¼Œå…¶æ¬¡æ‰è€ƒè™‘ä½¿ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°ã€‚

**é€šå¸¸ç±»çš„å¤ç”¨åˆ†ä¸ºç»§æ‰¿å¤ç”¨å’Œåˆæˆå¤ç”¨ä¸¤ç§ã€‚**

ç»§æ‰¿å¤ç”¨è™½ç„¶æœ‰ç®€å•å’Œæ˜“å®ç°çš„ä¼˜ç‚¹ï¼Œä½†å®ƒä¹Ÿå­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š

1. **ç»§æ‰¿å¤ç”¨ç ´åäº†ç±»çš„å°è£…æ€§ã€‚**å› ä¸ºç»§æ‰¿ä¼šå°†çˆ¶ç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»ï¼Œçˆ¶ç±»å¯¹å­ç±»æ˜¯é€æ˜çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œç™½ç®±â€å¤ç”¨ã€‚
2. **å­ç±»ä¸çˆ¶ç±»çš„è€¦åˆåº¦é«˜ã€‚**çˆ¶ç±»çš„å®ç°çš„ä»»ä½•æ”¹å˜éƒ½ä¼šå¯¼è‡´å­ç±»çš„å®ç°å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸åˆ©äºç±»çš„æ‰©å±•ä¸ç»´æŠ¤ã€‚
3. å®ƒé™åˆ¶äº†å¤ç”¨çš„çµæ´»æ€§ã€‚**ä»çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„å®ç°æ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å·²ç»å®šä¹‰ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶ä¸å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚**


é‡‡ç”¨ç»„åˆæˆ–èšåˆå¤ç”¨æ—¶ï¼Œå¯ä»¥å°†å·²æœ‰å¯¹è±¡çº³å…¥æ–°å¯¹è±¡ä¸­ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œæ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œå®ƒæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š

1. å®ƒç»´æŒäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºæˆåˆ†å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚æ˜¯æ–°å¯¹è±¡çœ‹ä¸è§çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œé»‘ç®±(åªå…³æ³¨å…¶åŠŸèƒ½æ•ˆæœ,ä¸å…³æ³¨å…¶å†…éƒ¨å®ç°ç»†èŠ‚)â€å¤ç”¨ã€‚
2. å¯¹è±¡é—´çš„è€¦åˆåº¦ä½ã€‚å¯ä»¥åœ¨ç±»çš„æˆå‘˜ä½ç½®å£°æ˜æŠ½è±¡ã€‚
3. å¤ç”¨çš„çµæ´»æ€§é«˜ã€‚è¿™ç§å¤ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œï¼Œæ–°å¯¹è±¡å¯ä»¥åŠ¨æ€åœ°å¼•ç”¨ä¸æˆåˆ†å¯¹è±¡ç±»å‹ç›¸åŒçš„å¯¹è±¡ã€‚

ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£åˆæˆå¤ç”¨åŸåˆ™

ã€ä¾‹ã€‘æ±½è½¦åˆ†ç±»ç®¡ç†ç¨‹åº

æ±½è½¦æŒ‰â€œåŠ¨åŠ›æºâ€åˆ’åˆ†å¯åˆ†ä¸ºæ±½æ²¹æ±½è½¦ã€ç”µåŠ¨æ±½è½¦ç­‰ï¼›æŒ‰â€œé¢œè‰²â€åˆ’åˆ†å¯åˆ†ä¸ºç™½è‰²æ±½è½¦ã€é»‘è‰²æ±½è½¦å’Œçº¢è‰²æ±½è½¦ç­‰ã€‚å¦‚æœåŒæ—¶è€ƒè™‘è¿™ä¸¤ç§åˆ†ç±»ï¼Œå…¶ç»„åˆå°±å¾ˆå¤šã€‚ç±»å›¾å¦‚ä¸‹ï¼š 

<img src="img/åˆæˆå¤ç”¨åŸåˆ™.png" alt="image-20191229173554296" style="zoom:80%;" />

ä»ä¸Šé¢ç±»å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½¿ç”¨ç»§æ‰¿å¤ç”¨äº§ç”Ÿäº†å¾ˆå¤šå­ç±»ï¼Œå¦‚æœç°åœ¨åˆæœ‰æ–°çš„åŠ¨åŠ›æºæˆ–è€…æ–°çš„é¢œè‰²çš„è¯ï¼Œå°±éœ€è¦å†å®šä¹‰æ–°çš„ç±»ã€‚æˆ‘ä»¬è¯•ç€å°†ç»§æ‰¿å¤ç”¨æ”¹ä¸ºèšåˆå¤ç”¨çœ‹ä¸€ä¸‹ã€‚

<img src="img/åˆæˆå¤ç”¨åŸåˆ™1.png" alt="image-20191229173554296" style="zoom:80%;" />



# 4ï¼Œåˆ›å»ºè€…æ¨¡å¼

åˆ›å»ºå‹æ¨¡å¼çš„ä¸»è¦å…³æ³¨ç‚¹æ˜¯â€œ**æ€æ ·åˆ›å»ºå¯¹è±¡**ï¼Ÿâ€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ã€‚

è¿™æ ·å¯ä»¥é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ï¼Œä½¿ç”¨è€…ä¸éœ€è¦å…³æ³¨å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ã€‚

åˆ›å»ºå‹æ¨¡å¼åˆ†ä¸ºï¼š

* å•ä¾‹æ¨¡å¼
* å·¥å‚æ–¹æ³•æ¨¡å¼
* æŠ½è±¡å·¥ç¨‹æ¨¡å¼
* åŸå‹æ¨¡å¼
* å»ºé€ è€…æ¨¡å¼

## 4.1 å•ä¾‹è®¾è®¡æ¨¡å¼

å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚

è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚

### 4.1.1 å•ä¾‹æ¨¡å¼çš„ç»“æ„

å•ä¾‹æ¨¡å¼çš„ä¸»è¦æœ‰ä»¥ä¸‹è§’è‰²ï¼š

* å•ä¾‹ç±»ã€‚åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ç±»
* è®¿é—®ç±»ã€‚ä½¿ç”¨å•ä¾‹ç±»

### 4.1.2 å•ä¾‹æ¨¡å¼çš„å®ç°

> å•ä¾‹è®¾è®¡æ¨¡å¼åˆ†ç±»ä¸¤ç§ï¼š
>
> â€‹	é¥¿æ±‰å¼ï¼šç±»åŠ è½½å°±ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»º	
>
> â€‹	æ‡’æ±‰å¼ï¼šç±»åŠ è½½ä¸ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºï¼Œè€Œæ˜¯é¦–æ¬¡ä½¿ç”¨è¯¥å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»º

#### 1.é¥¿æ±‰å¼-æ–¹å¼1ï¼ˆé™æ€å˜é‡æ–¹å¼ï¼‰

```java
/**
 * é¥¿æ±‰å¼
 *      é™æ€å˜é‡åˆ›å»ºç±»çš„å¯¹è±¡
 */
public class Singleton {
    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    //åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
    private static Singleton instance = new Singleton();

    //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static Singleton getInstance() {
        return instance;
    }
}
```

<font color='red'>è¯´æ˜ï¼š</font>

â€‹	è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶åˆ›å»ºSingletonç±»çš„å¯¹è±¡instanceã€‚**instanceå¯¹è±¡æ˜¯éšç€ç±»çš„åŠ è½½è€Œåˆ›å»ºçš„**(static)ã€‚å¦‚æœè¯¥å¯¹è±¡è¶³å¤Ÿå¤§çš„è¯ï¼Œè€Œä¸€ç›´æ²¡æœ‰ä½¿ç”¨å°±ä¼šé€ æˆå†…å­˜çš„æµªè´¹ã€‚



#### 2.é¥¿æ±‰å¼-æ–¹å¼2ï¼ˆé™æ€ä»£ç å—æ–¹å¼ï¼‰

```java
/**
 * æ¶æ±‰å¼
 *      åœ¨é™æ€ä»£ç å—ä¸­åˆ›å»ºè¯¥ç±»å¯¹è±¡
 */
public class Singleton {

    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    //åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
    private static Singleton instance;

    static {
        instance = new Singleton();
    }

    //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static Singleton getInstance() {
        return instance;
    }
}
```

<font color='red'>è¯´æ˜ï¼š</font>

â€‹	è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œè€Œå¯¹è±¡çš„åˆ›å»ºæ˜¯åœ¨é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯å¯¹ç€ç±»çš„åŠ è½½è€Œåˆ›å»ºã€‚æ‰€ä»¥å’Œé¥¿æ±‰å¼çš„æ–¹å¼1åŸºæœ¬ä¸Šä¸€æ ·ï¼Œå½“ç„¶è¯¥æ–¹å¼ä¹Ÿå­˜åœ¨å†…å­˜æµªè´¹é—®é¢˜ã€‚



#### 3.æ‡’æ±‰å¼-æ–¹å¼1ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰

```java
/**
 * æ‡’æ±‰å¼
 *  çº¿ç¨‹ä¸å®‰å…¨
 */
public class Singleton {
    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    //åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
    private static Singleton instance;

    //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static Singleton getInstance() {

        if(instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}
```

<font color='red'>è¯´æ˜ï¼š</font>

â€‹	ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå¯¹è±¡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„å‘¢ï¼Ÿå½“è°ƒç”¨getInstance()æ–¹æ³•è·å–Singletonç±»çš„å¯¹è±¡çš„æ—¶å€™æ‰åˆ›å»ºSingletonç±»çš„å¯¹è±¡ï¼Œè¿™æ ·å°±å®ç°äº†æ‡’åŠ è½½çš„æ•ˆæœã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹ç¯å¢ƒï¼Œä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚



#### 4.æ‡’æ±‰å¼-æ–¹å¼2ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰

```java
/**
 * æ‡’æ±‰å¼
 *  çº¿ç¨‹å®‰å…¨
 */
public class Singleton {
    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    //åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡
    private static Singleton instance;

    //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static synchronized Singleton getInstance() {

        if(instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}
```

<font color='red'>è¯´æ˜ï¼š</font>

â€‹	è¯¥æ–¹å¼ä¹Ÿå®ç°äº†**æ‡’åŠ è½½æ•ˆæœ**ï¼ŒåŒæ—¶åˆè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯åœ¨getInstance()æ–¹æ³•ä¸Šæ·»åŠ äº†synchronizedå…³é”®å­—ï¼Œå¯¼è‡´è¯¥æ–¹æ³•çš„æ‰§è¡Œæ•ˆæœç‰¹åˆ«ä½ã€‚ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå…¶å®å°±æ˜¯åœ¨åˆå§‹åŒ–instanceçš„æ—¶å€™æ‰ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸€æ—¦åˆå§‹åŒ–å®Œæˆå°±ä¸å­˜åœ¨äº†ã€‚



#### 5.æ‡’æ±‰å¼-æ–¹å¼3ï¼ˆåŒé‡æ£€æŸ¥é”ï¼‰

å†æ¥è®¨è®ºä¸€ä¸‹æ‡’æ±‰æ¨¡å¼ä¸­åŠ é”çš„é—®é¢˜ï¼Œå¯¹äº `getInstance()` æ–¹æ³•æ¥è¯´ï¼Œç»å¤§éƒ¨åˆ†çš„æ“ä½œéƒ½æ˜¯è¯»æ“ä½œï¼Œ**è¯»æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„**ï¼ˆæ‰€ä»¥åªéœ€è¦æ³¨æ„å†™æ“ä½œï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡å¿…è®©æ¯ä¸ªçº¿ç¨‹å¿…é¡»æŒæœ‰é”æ‰èƒ½è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´åŠ é”çš„æ—¶æœºã€‚ç”±æ­¤ä¹Ÿäº§ç”Ÿäº†ä¸€ç§æ–°çš„å®ç°æ¨¡å¼ï¼šåŒé‡æ£€æŸ¥é”æ¨¡å¼

```java
/**
 * åŒé‡æ£€æŸ¥æ–¹å¼
 */
public class Singleton { 

    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    private static Singleton instance;

   //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static Singleton getInstance() {
		//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœinstanceä¸ä¸ºnullï¼Œä¸è¿›å…¥æŠ¢é”é˜¶æ®µï¼Œç›´æ¥è¿”å›å®ä¾‹
        if(instance == null) {
            synchronized (Singleton.class) {
                //æŠ¢åˆ°é”ä¹‹åå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸ºnull
                if(instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§éå¸¸å¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œè§£å†³äº†å•ä¾‹ã€æ€§èƒ½ã€çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸Šé¢çš„åŒé‡æ£€æµ‹é”æ¨¡å¼çœ‹ä¸Šå»å®Œç¾æ— ç¼ºï¼Œå…¶å®æ˜¯å­˜åœ¨é—®é¢˜ï¼Œåœ¨**å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹**ï¼Œ**å¯èƒ½ä¼šå‡ºç°ç©ºæŒ‡é’ˆé—®é¢˜**ï¼Œ**å‡ºç°é—®é¢˜çš„åŸå› æ˜¯JVMåœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šè¿›è¡Œä¼˜åŒ–å’ŒæŒ‡ä»¤é‡æ’åºæ“ä½œã€‚**

è¦è§£å†³åŒé‡æ£€æŸ¥é”æ¨¡å¼å¸¦æ¥ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é—®é¢˜ï¼Œåªéœ€è¦ä½¿ç”¨ `volatile` å…³é”®å­—, `volatile` å…³é”®å­—å¯ä»¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ã€‚

```java
/**
 * åŒé‡æ£€æŸ¥æ–¹å¼
 */
public class Singleton {

    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    private static volatile Singleton instance;

   //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static Singleton getInstance() {
		//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœinstanceä¸ä¸ºnullï¼Œä¸è¿›å…¥æŠ¢é”é˜¶æ®µï¼Œç›´æ¥è¿”å›å®é™…
        if(instance == null) {
            synchronized (Singleton.class) {
                //æŠ¢åˆ°é”ä¹‹åå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸ºç©º
                if(instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

<font color="red">å°ç»“ï¼š</font>

æ·»åŠ  `volatile` å…³é”®å­—ä¹‹åçš„åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œèƒ½å¤Ÿä¿è¯åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹çº¿ç¨‹å®‰å…¨ä¹Ÿä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚



#### 6.æ‡’æ±‰å¼-æ–¹å¼4ï¼ˆé™æ€å†…éƒ¨ç±»æ–¹å¼ï¼‰

é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ä¸­å®ä¾‹ç”±å†…éƒ¨ç±»åˆ›å»ºï¼Œç”±äº **JVM åœ¨åŠ è½½å¤–éƒ¨ç±»çš„è¿‡ç¨‹ä¸­, æ˜¯ä¸ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»çš„**, åªæœ‰å†…éƒ¨ç±»çš„å±æ€§/æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰ä¼šè¢«åŠ è½½, å¹¶åˆå§‹åŒ–å…¶é™æ€å±æ€§ã€‚é™æ€å±æ€§ç”±äºè¢« `static` ä¿®é¥°ï¼Œä¿è¯åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œå¹¶ä¸”ä¸¥æ ¼ä¿è¯å®ä¾‹åŒ–é¡ºåºã€‚

```java
/**
 * é™æ€å†…éƒ¨ç±»æ–¹å¼
 */
public class Singleton {

    //ç§æœ‰æ„é€ æ–¹æ³•
    private Singleton() {}

    private static class SingletonHolder {
        private static final Singleton INSTANCE = new Singleton();
    }

    //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
    public static Singleton getInstance() {
        return SingletonHolder.INSTANCE;
    }
}
```

<font color='red'>è¯´æ˜ï¼š</font>

â€‹	ç¬¬ä¸€æ¬¡åŠ è½½Singletonç±»æ—¶ä¸ä¼šå»åˆå§‹åŒ–INSTANCEï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceï¼Œè™šæ‹ŸæœºåŠ è½½SingletonHolder

å¹¶åˆå§‹åŒ–INSTANCEï¼Œè¿™æ ·ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯ Singleton ç±»çš„å”¯ä¸€æ€§ã€‚

<font color="red">å°ç»“ï¼š</font>

â€‹	é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§ä¼˜ç§€çš„å•ä¾‹æ¨¡å¼ï¼Œæ˜¯å¼€æºé¡¹ç›®ä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å•ä¾‹æ¨¡å¼ã€‚åœ¨æ²¡æœ‰åŠ ä»»ä½•é”çš„æƒ…å†µä¸‹ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¸‹çš„å®‰å…¨ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•æ€§èƒ½å½±å“å’Œç©ºé—´çš„æµªè´¹ã€‚



#### 7.æšä¸¾æ–¹å¼

æšä¸¾ç±»å®ç°å•ä¾‹æ¨¡å¼æ˜¯æåŠ›æ¨èçš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œå› ä¸º**æšä¸¾ç±»å‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹¶ä¸”åªä¼šè£…è½½ä¸€æ¬¡**ï¼Œè®¾è®¡è€…å……åˆ†çš„åˆ©ç”¨äº†æšä¸¾çš„è¿™ä¸ªç‰¹æ€§æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œæšä¸¾çš„å†™æ³•éå¸¸ç®€å•ï¼Œè€Œä¸”æšä¸¾ç±»å‹æ˜¯æ‰€ç”¨å•ä¾‹å®ç°ä¸­å”¯ä¸€ä¸€ç§ä¸ä¼šè¢«ç ´åçš„å•ä¾‹å®ç°æ¨¡å¼ã€‚

```java
/**
 * æšä¸¾æ–¹å¼
 */
public enum Singleton {
    INSTANCE;
}
```

<font color='red'>è¯´æ˜ï¼š</font>

â€‹	æšä¸¾æ–¹å¼å±äºæ¶æ±‰å¼æ–¹å¼ã€‚




### 4.1.3 å­˜åœ¨çš„é—®é¢˜(ç ´åå•ä¾‹)

#### 4.1.3.1 é—®é¢˜æ¼”ç¤º

ç ´åå•ä¾‹æ¨¡å¼ï¼š

ä½¿ä¸Šé¢å®šä¹‰çš„å•ä¾‹ç±»ï¼ˆSingletonï¼‰å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œæšä¸¾æ–¹å¼é™¤å¤–ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯åºåˆ—åŒ–å’Œåå°„ã€‚

* åºåˆ—åŒ–ååºåˆ—åŒ–

  **Singletonç±»ï¼š**

  ```java
  public class Singleton implements Serializable {
  
      //ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
  
      private static class SingletonHolder {
          private static final Singleton INSTANCE = new Singleton();
      }
  
      //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          return SingletonHolder.INSTANCE;
      }
  }
  ```

  **Testç±»ï¼š**

  ```java
  public class Test {
      public static void main(String[] args) throws Exception {
          //å¾€æ–‡ä»¶ä¸­å†™å¯¹è±¡
          //writeObject2File();
          //ä»æ–‡ä»¶ä¸­è¯»å–å¯¹è±¡
          Singleton s1 = readObjectFromFile();
          Singleton s2 = readObjectFromFile();
  
          //åˆ¤æ–­ä¸¤ä¸ªååºåˆ—åŒ–åçš„å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡
          System.out.println(s1 == s2);
      }
  
      private static Singleton readObjectFromFile() throws Exception {
          //åˆ›å»ºå¯¹è±¡è¾“å…¥æµå¯¹è±¡
          ObjectInputStream ois = new ObjectInputStream(new FileInputStream("C:\\Users\\Think\\Desktop\\a.txt"));
          //ç¬¬ä¸€ä¸ªè¯»å–Singletonå¯¹è±¡
          Singleton instance = (Singleton) ois.readObject();
  
          return instance;
      }
  
      public static void writeObject2File() throws Exception {
          //è·å–Singletonç±»çš„å¯¹è±¡
          Singleton instance = Singleton.getInstance();
          //åˆ›å»ºå¯¹è±¡è¾“å‡ºæµ
          ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("C:\\Users\\Think\\Desktop\\a.txt"));
          //å°†instanceå¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­
          oos.writeObject(instance);
      }
  }
  ```

  > ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯`false`ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚

* åå°„

  **Singletonç±»ï¼š**

  ```java
  public class Singleton {
  
      //ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
      
      private static volatile Singleton instance;
  
      //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
  
          if(instance != null) {
              return instance;
          }
  
          synchronized (Singleton.class) {
              if(instance != null) {
                  return instance;
              }
              instance = new Singleton();
              return instance;
          }
      }
  }
  ```

  **Testç±»ï¼š**

  ```java
  public class Test {
      public static void main(String[] args) throws Exception {
          //è·å–Singletonç±»çš„å­—èŠ‚ç å¯¹è±¡
          Class clazz = Singleton.class;
          //è·å–Singletonç±»çš„ç§æœ‰æ— å‚æ„é€ æ–¹æ³•å¯¹è±¡
          Constructor constructor = clazz.getDeclaredConstructor();
          //å–æ¶ˆè®¿é—®æ£€æŸ¥
          constructor.setAccessible(true);
  
          //åˆ›å»ºSingletonç±»çš„å¯¹è±¡s1
          Singleton s1 = (Singleton) constructor.newInstance();
          //åˆ›å»ºSingletonç±»çš„å¯¹è±¡s2
          Singleton s2 = (Singleton) constructor.newInstance();
  
          //åˆ¤æ–­é€šè¿‡åå°„åˆ›å»ºçš„ä¸¤ä¸ªSingletonå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡
          System.out.println(s1 == s2);
      }
  }
  ```

  > ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯`false`ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼

> <font color="red">æ³¨æ„ï¼š</font>æšä¸¾æ–¹å¼ä¸ä¼šå‡ºç°è¿™ä¸¤ä¸ªé—®é¢˜ã€‚



#### 4.1.3.2 é—®é¢˜çš„è§£å†³

* åºåˆ—åŒ–ã€ååºåˆ—æ–¹å¼ç ´åå•ä¾‹æ¨¡å¼çš„è§£å†³æ–¹æ³•

  åœ¨Singletonç±»ä¸­æ·»åŠ `readResolve()`æ–¹æ³•ï¼Œ**åœ¨ååºåˆ—åŒ–æ—¶è¢«åå°„è°ƒç”¨**ï¼Œå¦‚æœå®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°±è¿”å›è¿™ä¸ªæ–¹æ³•çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™è¿”å›æ–°newå‡ºæ¥çš„å¯¹è±¡ã€‚

  **Singletonç±»ï¼š**

  ```java
  public class Singleton implements Serializable {
  
      //ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {}
  
      private static class SingletonHolder {
          private static final Singleton INSTANCE = new Singleton();
      }
  
      //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
          return SingletonHolder.INSTANCE;
      }
      
      /**
       * ä¸‹é¢æ˜¯ä¸ºäº†è§£å†³åºåˆ—åŒ–ååºåˆ—åŒ–ç ´è§£å•ä¾‹æ¨¡å¼
       */
      private Object readResolve() {
          return SingletonHolder.INSTANCE;
      }
  }
  ```

  **æºç è§£æï¼š**

  ObjectInputStreamç±»

  ```java
  public final Object readObject() throws IOException, ClassNotFoundException{
      ...
      // if nested read, passHandle contains handle of enclosing object
      int outerHandle = passHandle;
      try {
          Object obj = readObject0(false);//é‡ç‚¹æŸ¥çœ‹readObject0æ–¹æ³•
      .....
  }
      
  private Object readObject0(boolean unshared) throws IOException {
  	...
      try {
  		switch (tc) {
  			...
  			case TC_OBJECT:
  				return checkResolve(readOrdinaryObject(unshared));//é‡ç‚¹æŸ¥çœ‹readOrdinaryObjectæ–¹æ³•
  			...
          }
      } finally {
          depth--;
          bin.setBlockDataMode(oldMode);
      }    
  }
      
  private Object readOrdinaryObject(boolean unshared) throws IOException {
  	...
  	//isInstantiable è¿”å›trueï¼Œæ‰§è¡Œ desc.newInstance()ï¼Œé€šè¿‡åå°„åˆ›å»ºæ–°çš„å•ä¾‹ç±»ï¼Œ
      obj = desc.isInstantiable() ? desc.newInstance() : null; 
      ...
      // åœ¨Singletonç±»ä¸­æ·»åŠ  readResolve æ–¹æ³•å desc.hasReadResolveMethod() æ–¹æ³•æ‰§è¡Œç»“æœä¸ºtrue
      if (obj != null && handles.lookupException(passHandle) == null && desc.hasReadResolveMethod()) {
      	// é€šè¿‡åå°„è°ƒç”¨ Singleton ç±»ä¸­çš„ readResolve æ–¹æ³•ï¼Œå°†è¿”å›å€¼èµ‹å€¼ç»™repå˜é‡
      	// è¿™æ ·å¤šæ¬¡è°ƒç”¨ObjectInputStreamç±»ä¸­çš„readObjectæ–¹æ³•ï¼Œç»§è€Œå°±ä¼šè°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„readResolveæ–¹æ³•ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚
      	Object rep = desc.invokeReadResolve(obj);
       	...
      }
      return obj;
  }
  ```

* åå°„æ–¹å¼ç ´è§£å•ä¾‹çš„è§£å†³æ–¹æ³•

  ```java
  public class Singleton {
  
      //ç§æœ‰æ„é€ æ–¹æ³•
      private Singleton() {
          /*
             åå°„ç ´è§£å•ä¾‹æ¨¡å¼éœ€è¦æ·»åŠ çš„ä»£ç 
          */
          if(instance != null) {
              throw new RuntimeException();
          }
      }
      
      private static volatile Singleton instance;
  
      //å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡
      public static Singleton getInstance() {
  
          if(instance != null) {
              return instance;
          }
  
          synchronized (Singleton.class) {
              if(instance != null) {
                  return instance;
              }
              instance = new Singleton();
              return instance;
          }
      }
  }
  ```

  <font color="red">è¯´æ˜:</font>

  â€‹	è¿™ç§æ–¹å¼æ¯”è¾ƒå¥½ç†è§£ã€‚å½“é€šè¿‡åå°„æ–¹å¼è°ƒç”¨æ„é€ æ–¹æ³•è¿›è¡Œåˆ›å»ºåˆ›å»ºæ—¶ï¼Œç›´æ¥æŠ›å¼‚å¸¸ã€‚ä¸è¿è¡Œæ­¤ä¸­æ“ä½œã€‚



### 4.1.4 JDKæºç è§£æ-Runtimeç±»

Runtimeç±»å°±æ˜¯ä½¿ç”¨çš„å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚

1. é€šè¿‡æºä»£ç æŸ¥çœ‹ä½¿ç”¨çš„æ˜¯å“ªå„¿ç§å•ä¾‹æ¨¡å¼

   ```java
   public class Runtime {
       private static Runtime currentRuntime = new Runtime();
   
       /**
        * Returns the runtime object associated with the current Java application.
        * Most of the methods of class <code>Runtime</code> are instance
        * methods and must be invoked with respect to the current runtime object.
        *
        * @return  the <code>Runtime</code> object associated with the current
        *          Java application.
        */
       public static Runtime getRuntime() {
           return currentRuntime;
       }
   
       /** Don't let anyone else instantiate this class */
       private Runtime() {}
       ...
   }
   ```

   ä»ä¸Šé¢æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºRuntimeç±»ä½¿ç”¨çš„æ˜¯é¥¿æ±‰å¼ï¼ˆé™æ€å±æ€§ï¼‰æ–¹å¼æ¥å®ç°å•ä¾‹æ¨¡å¼çš„ã€‚

   

2. ä½¿ç”¨Runtimeç±»ä¸­çš„æ–¹æ³•

   ```java
   public class RuntimeDemo {
       public static void main(String[] args) throws IOException {
           //è·å–Runtimeç±»å¯¹è±¡
           Runtime runtime = Runtime.getRuntime();
   
           //è¿”å› Java è™šæ‹Ÿæœºä¸­çš„å†…å­˜æ€»é‡ã€‚
           System.out.println(runtime.totalMemory());
           //è¿”å› Java è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡ã€‚
           System.out.println(runtime.maxMemory());
   
           //åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æ‰§è¡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²å‘½ä»¤ï¼Œè¿”å›è¿›ç¨‹å¯¹è±¡
           Process process = runtime.exec("ipconfig");
           //è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œé€šè¿‡è¾“å…¥æµè·å–
           InputStream inputStream = process.getInputStream();
           byte[] arr = new byte[1024 * 1024* 100];
           int b = inputStream.read(arr);
           System.out.println(new String(arr,0,b,"gbk"));
       }
   }
   ```

   